import{getContext as t,getElement as e,store as n}from"@wordpress/interactivity";const a=wp.apiFetch,o=()=>window.crypto&&"randomUUID"in window.crypto?window.crypto.randomUUID():"vc_"+Math.random().toString(36).slice(2)+Date.now().toString(36),i=()=>{try{const t="optincraft_visitor_id";let e=localStorage.getItem(t);return e||(e=o(),localStorage.setItem(t,e)),e}catch(t){return o()}},s=()=>{try{const t="optincraft_session_id";let e=sessionStorage.getItem(t);return e||(e=o(),sessionStorage.setItem(t,e)),e}catch(t){return o()}},r=()=>{const t=window.innerWidth||document.documentElement.clientWidth;return t<=768?"mobile":t<=1024?"tablet":"desktop"},l=()=>{const t=navigator.userAgent;return t.includes("Chrome")&&!t.includes("Edge")?"Chrome":t.includes("Safari")&&!t.includes("Chrome")?"Safari":t.includes("Firefox")?"Firefox":t.includes("Edg")?"Edge":"Other"},c=t=>{try{return new URL(t).hostname}catch(t){return""}},p=()=>{const t=document.referrer||"";return t?c(window.location.href)===c(t)?"":t:""},d=async(t,e,n)=>{try{await a({path:"/optincraft/events",method:"POST",data:{campaign_id:t,event_type:e,page_url:window.location.href,referrer:p(),device:r(),browser:l(),revenue:null!=n?n:0,visitor_id:i(),session_id:s()}})}catch(t){}};function u(t){return wp.apiFetch(t)}function f(){return window.lodash||window._}function m(t,e){var n;t.isShowing=!0,null!==(n=t.settings.prevent_background_scroll)&&void 0!==n&&n&&(document.body.style.overflow="hidden"),function(t){const e="optincraft_viewed_campaigns";try{const n=localStorage.getItem(e);let a=n?JSON.parse(n):{};a[t.campaign_id]||(a[t.campaign_id]={view_count:0,first_viewed_at:Date.now(),last_viewed_at:Date.now()}),a[t.campaign_id].view_count+=1,a[t.campaign_id].last_viewed_at=Date.now(),localStorage.setItem(e,JSON.stringify(a))}catch(t){console.warn("Failed to store campaign view data:",t)}}(t),d(Number(t.campaign_id),"impression")}function _(t,e,n){var a;t.isShowing=!1,setTimeout(()=>{e.style.height="0",e.style.width="0"},400),null!==(a=t.settings.prevent_background_scroll)&&void 0!==a&&a&&document.body.style.removeProperty("overflow");try{const e="optincraft_closed_campaigns",n=localStorage.getItem(e);let a=n?JSON.parse(n):{};a[t.campaign_id]={closed_at:Date.now()},localStorage.setItem(e,JSON.stringify(a))}catch(t){console.warn("Failed to store campaign close time:",t)}wp.hooks.doAction("optincraft_campaign_closed",t,n)}function y(t,e){const n=t.ref?.closest(".optincraft-campaign"),a=n?.querySelector(".optincraft-campaign-content"),o=n?.querySelector(".optincraft-campaign-overlay");if(!a)return void _(e,o,t);const i=n?.querySelector(".optincraft-form-wrapper"),s=e.settings,r=e.type,l=s.exit_animation;"fade_out"===l&&(a.style.opacity="0");const c={floating_bar:{slide_out_left:"translate(-100%, 0)",slide_out_right:"translate(100%, 0)",slide_out_up:"translate(0, -100%)",slide_out_down:"translate(0, 100%)"},slide_in:{slide_out_left:"translate(-100%, 0)",slide_out_right:"translate(calc(100% + 20px), 0)",slide_out_up:"translate(0, calc(-100% - 1000px))",slide_out_down:"translate(0, calc(100% + 20px))"},popup:{slide_out_left:"translate(-100%, -50%)",slide_out_right:"translate(100%, -50%)",slide_out_up:"translate(-50%, -100%)",slide_out_down:"translate(-50%, 100%)"}};if(c[r]?.[l]){if("slide_out_up"===l&&"floating_bar"===r&&i){const t=i,e="0.3s cubic-bezier(0.4, 0, 0.2, 1)";t.style.transition=`height ${e}`,t.style.willChange="height",a.style.transition=`transform ${e}`,a.style.willChange="transform",requestAnimationFrame(()=>{t.style.height="0",setTimeout(()=>{t.style.willChange="auto",a.style.willChange="auto"},350)})}a.style.transform=c[r][l],"popup"===r&&(l.includes("left")&&(a.style.left="0"),l.includes("right")&&(a.style.right="0"),l.includes("up")&&(a.style.top="0"),l.includes("down")&&(a.style.bottom="0"))}const p={back_out_left:"translate(-100%, 0)",back_out_right:"slide_in"===r?"translate(calc(100% + 20px), 0)":"translate(100%, 0)",back_out_up:"slide_in"===r?"translate(0, calc(-100% - 1000px))":"translate(0, -100%)",back_out_down:"slide_in"===r?"translate(0, calc(100% + 20px))":"translate(0, 100%)"};if(l.startsWith("back_out")){a.style.transition="transform 0.4s, opacity 0.4s";const t="popup"===r?"translate(-50%, -50%) scale(0.7)":"translate(0, 0) scale(0.7)";a.style.transform=t,setTimeout(()=>{const t=p[l];if("popup"===r){const e="translate(-50%, -50%) ";a.style.transform=e+t.replace("translate(","").replace(")","")+" scale(0.7)"}else a.style.transform=t+" scale(0.7)";a.style.opacity="0"},600)}if("bounce_out"===l){const t="popup"===r?"translate(-50%, -50%)":"translate(0, 0)";a.style.transform=`${t} scale(0.9)`,setTimeout(()=>{a.style.transform=`${t} scale(1.1)`},250),setTimeout(()=>{a.style.opacity="0",a.style.transform=`${t} scale(0.3)`},450)}if("rotate_out"===l){const t="popup"===r?"translate(-50%, -50%)":"translate(0, 0)";a.style.transform=`${t} rotate(200deg)`,setTimeout(()=>a.style.opacity="0",500)}if("zoom_out"===l){const t="translate(0, 0)";a.style.transform=`${t} scale(.3)`,setTimeout(()=>{a.style.opacity="0"},300)}setTimeout(()=>{_(e,o,t),"floating_bar"!==e.type&&(a.style.display="none"),"slide_out_up"===l&&"floating_bar"===r||(i.style.height="0")},800)}function g(){return"undefined"==typeof window?"desktop":window.matchMedia("(max-width: 767px)").matches?"mobile":window.matchMedia("(min-width: 768px) and (max-width: 1024px)").matches?"tablet":"desktop"}function h(t){const e="optincraft_actioned_campaigns",n=localStorage.getItem(e);let a=n?JSON.parse(n):{};a[t.campaign_id]={actioned_at:Date.now()},localStorage.setItem(e,JSON.stringify(a))}function w(t){return window.innerWidth<=768?t.mobile:window.innerWidth<=1024?t.tablet:t.desktop}function b(t){return window.innerWidth<=768?t.mobile:window.innerWidth<=1024?t.tablet:t.desktop}function v(t){const e=t.stepIds,n=t.activeStepId,a=e[e.indexOf(n)+1];t.activeStepId=a}const{isEmpty:$,isObject:k}=f(),S=t=>{if($(t))return{backgroundImage:"none",backgroundPosition:"center",backgroundSize:"auto",backgroundRepeat:"no-repeat"};let e="auto";switch(t.backgroundType){case"cover":e="cover";break;case"contain":e="contain";break;default:0!==t.width.length&&(e=t.width)}return{backgroundImage:`url(${t.url})`,backgroundPosition:`${t.focalPoint.left}% ${t.focalPoint.top}%`,backgroundSize:e,backgroundRepeat:t.repeat?"repeat":"no-repeat"}},x=t=>{const{color:e,width:n,style:a="solid"}=t;if(e||n)return{border:`${n||"0px"} ${a} ${e||""}`};const{top:o={},right:i={},bottom:s={},left:r={}}=t;return{borderTop:`${o.width||"0px"} ${o.style||"solid"} ${o.color||""}`,borderRight:`${i.width||"0px"} ${i.style||"solid"} ${i.color||""}`,borderBottom:`${s.width||"0px"} ${s.style||"solid"} ${s.color||""}`,borderLeft:`${r.width||"0px"} ${r.style||"solid"} ${r.color||""}`}},T=t=>{if("object"==typeof t){const{topLeft:e,topRight:n,bottomLeft:a,bottomRight:o}=t;return{borderTopLeftRadius:e||0,borderTopRightRadius:n||0,borderBottomLeftRadius:a||0,borderBottomRightRadius:o||0}}return{borderRadius:t||0}},O=jQuery,{isEmpty:I}=f();function E(t){return Object.entries(t).map(([t,e])=>`${t.replace(/([A-Z])/g,"-$1").toLowerCase()}: ${e};`).join(" ")}const C=["Inter","Arial","Tahoma","Verdana","Helvetica","Times New Roman","Trebuchet MX","Georgia"],L=(t,e)=>{const n=function(t,e,n){var a;const o=((a=window).optincraftGlobalState||(a.optincraftGlobalState={})).admin;if(!o)return n;const i=o;return i&&Object.prototype.hasOwnProperty.call(i,e)?i[e]:n}(0,"optincraft_load_font_family",null);if(!n?.hasOwnProperty(t)&&!C.includes(t)){!function(t,e,n,a=!1,o){var i;window.optincraftGlobalState||(window.optincraftGlobalState={});const s=(i=window.optincraftGlobalState)[t]||(i[t]={}),r=void 0!==o?s[o]||(s[o]={}):s,l=a&&isObject(n)&&isObject(r[e])?{...r[e],...n}:n;r[e]=l}("admin","optincraft_load_font_family",{...n,[t]:t});const a=document.createElement("link");a.href=`https://fonts.googleapis.com/css?family=${t}:${e}`,a.rel="stylesheet",a.type="text/css",document.body.appendChild(a)}};n("optincraft/campaign",{state:{isStepShowing:()=>{const e=t();return e.stepId===e.activeStepId}},callbacks:{init:function(){const n=t(),a=e();if(!a.ref)return;const o=a.ref.querySelector(".optincraft-campaign-content"),i=a.ref.querySelector(".optincraft-form-wrapper");if(!o)return;const s=n.settings,r=g();let l={};if("color"===s.background_type)l.background=s.colors.background.default;else if("image"===s.background_type){const t=s?.background_image;t?.desktop?function(t,e){if(!t?.desktop)return;const n=`optincraft-bg-image-${e}`;if(document.getElementById(n))return;const a=`.optincraft-campaign-${e} .optincraft-campaign-content`;let o=`\n\t\t${a} {\n\t\t\t${E(S(t?.desktop))}\n\t\t}\n\t`;I(t?.tablet)||(o+=`\n\t\t\t@media (max-width: 1024px) {\n\t\t\t\t${a} {\n\t\t\t\t\t${E(S(t?.tablet))}\n\t\t\t\t}\n\t\t\t}\n\t\t`),I(t?.mobile)||(o+=`\n\t\t\t@media (max-width: 768px) {\n\t\t\t\t${a} {\n\t\t\t\t\t${E(S(t?.mobile))}\n\t\t\t\t}\n\t\t\t}\n\t\t`);const i=document.createElement("style");i.id=n,i.textContent=o,document.head.appendChild(i)}(t,n.campaign_id):l={...l,...S(t)}}if(s.border?.border&&(l={...l,...x(s.border.border)}),s.border?.radius&&(l={...l,...T(s.border.radius)}),Object.assign(o.style,{...l}),!s[`show_${r}`])return;switch(n.type){case"floating_bar":i.style.width=b(n.width),i.style.height="0px",o.style.boxShadow="none";break;case"popup":i.style.width=b(n.width),i.style.height="0px",Object.assign(o.style,{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",display:"none",transition:"opacity 0.3s ease-in, transform 0.3s ease-in, left 0.3s ease-in, right 0.3s ease-in, top 0.3s ease-in, bottom 0.3s ease-in"});break;case"slide_in":i.style.width=b(n.width),Object.assign(o.style,{position:"fixed",boxShadow:"none",display:"none",..."top"===s.vertical_position?{top:"20px"}:{bottom:"20px"},..."left"===s.horizontal_position?{left:"20px"}:{right:"20px"},zIndex:"-1"})}!function(t,e,n,a,o){if(!t)return()=>{};let i=o;const s=()=>{const a=g();a!==i&&(i=a,(()=>{if(!t)return;const a=t,o=g();if(!n[`show_${o}`])return;e.width&&(a.style.width=b(e.width));const i=a.style.height;e.height&&i&&"0px"!==i&&"0"!==i&&(a.style.height=w(e.height))})())};let r=null;const l=()=>{r&&clearTimeout(r),r=setTimeout(s,150)};window.addEventListener("resize",l);const c=()=>{window.removeEventListener("resize",l),r&&clearTimeout(r)},p=new MutationObserver(()=>{document.body.contains(a.ref)||(c(),p.disconnect())});a.ref&&p.observe(document.body,{childList:!0,subtree:!0})}(i,n,s,a,r);const c=s.entrance_animation,p=n.type,d="0.3s ease-in",u="0.7s, opacity 0.1s",f="0.75s cubic-bezier(0.215,0.610,0.355,1), opacity 0.3s ease-out",_="0.75s, opacity 0.4s ease-out",y="0.6s cubic-bezier(0.215,0.610,0.355,1), opacity 0.3s ease-out",v={fade_in:{popup:{opacity:"0",transform:"translate(-50%, -50%)",transition:"opacity 0.3s ease-in, transform 0.3s ease-in, position 0.3s ease-in"},floating_bar:{opacity:"0",transform:"translate(0,0)",transition:`opacity ${d}, transform ${d}`},slide_in:{opacity:"0",transform:"translate(0,0)",transition:`opacity ${d}, transform ${d}`}},slide_in_left:{popup:{opacity:"0",transform:"translate(-100%,-50%)"},floating_bar:{transform:"translate(-100%,-50%)",transition:`transform ${d}`},slide_in:{transform:"translate(-100%,0)",transition:`transform ${d}`}},slide_in_right:{popup:{opacity:"0",transform:"translate(100%,-50%)"},floating_bar:{transform:"translate(100%,-50%)",transition:`transform ${d}`},slide_in:{transform:"translate(calc(100% + 20px),0)",transition:`transform ${d}`}},slide_in_down:{popup:{opacity:"0",transform:"translate(-50%,-100%)"},floating_bar:{transform:"translate(0,-100%)",transition:`transform ${d}`},slide_in:{transform:"translate(0,-100%)",transition:`transform ${d}`}},slide_in_up:{popup:{opacity:"0",transform:"translate(-50%,100%)"},floating_bar:{transform:"translate(0,100%)",transition:`transform ${d}`},slide_in:{transform:"translate(0,calc(100% + 20px))",transition:`transform ${d}`}},back_in_left:{popup:{opacity:"0",transform:"translate(calc(50% - 2000px), -50%) scale(0.7)",transition:`transform ${u}`},floating_bar:{opacity:"0",transform:"translate(-100%,0) scale(0.7)",transition:`transform ${u}`},slide_in:{opacity:"0",transform:"translate(-100%,0) scale(0.7)",transition:`transform ${u}`}},back_in_right:{popup:{opacity:"0",transform:"translate(100%, -50%) scale(0.7)",transition:`transform ${u}`},floating_bar:{opacity:"0",transform:"translate(100%,0) scale(0.7)",transition:`transform ${u}`},slide_in:{opacity:"0",transform:"translate(100%,0) scale(0.7)",transition:`transform ${u}`}},back_in_up:{popup:{opacity:"0",transform:"translate(-50%,100%) scale(0.7)",transition:`transform ${u}`},floating_bar:{opacity:"0",transform:"translate(0,100%) scale(0.7)",transition:`transform ${u}`},slide_in:{opacity:"0",transform:"translate(0,100%) scale(0.7)",transition:`transform ${u}`}},back_in_down:{popup:{opacity:"0",transform:"translate(-50%,-100%) scale(0.7)",transition:`transform ${u}`},floating_bar:{opacity:"0",transform:"translate(0,-100%) scale(0.7)",transition:`transform ${u}`},slide_in:{opacity:"0",transform:"translate(0,-100%) scale(0.7)",transition:`transform ${u}`}},bounce_in:{popup:{opacity:"0",transform:"translate(-50%, -50%) scale(0.3)",transition:f},floating_bar:{opacity:"0",transform:"translate(0,0) scale(0.3)",transition:f},slide_in:{opacity:"0",transform:"translate(0,0) scale(0.3)",transition:f}},rotate_in:{popup:{opacity:"0",transform:"translate(-50%, -50%) rotate(-200deg)",transition:_},floating_bar:{opacity:"0",transform:"translate(0,0) rotate(-200deg)",transition:_},slide_in:{opacity:"0",transform:"translate(0,0) rotate(-200deg)",transition:_}},zoom_in:{popup:{opacity:"0",transform:"translate(-50%,-50%) scale(0.3)",transition:y},floating_bar:{opacity:"0",transform:"translate(0,0) scale(0.3)",transition:y},slide_in:{opacity:"0",transform:"translate(0,0) scale(0.3)",transition:y}}},$=v[c]?.[p];if($&&Object.entries($).forEach(([t,e])=>{o.style[t]=e}),!n.showForcefully){if(!wp.hooks.applyFilters("optincraft_is_allowed_to_show_campaign",!0,n))return;if(s.stop_on_close){const t=localStorage.getItem("optincraft_closed_campaigns");if(t&&JSON.parse(t)[n.campaign_id])return}if(s.stop_on_action&&function(t){const e=localStorage.getItem("optincraft_actioned_campaigns");return!!(e?JSON.parse(e):{})[t.campaign_id]}(n))return;if(function(t){const e=t.settings.display_frequency,n=t.settings.display_once_every,a=t.settings.display_once_every_interval;try{switch(e){case"every_page_load":return!1;case"display_once_every":if(!n||!a)return!1;const e="optincraft_viewed_campaigns",o=localStorage.getItem(e),i=o?JSON.parse(o):{};if(!i[t.campaign_id])return!1;const s=i[t.campaign_id];return Date.now()-s.last_viewed_at<({seconds:1e3,minutes:6e4,hours:36e5,days:864e5,weeks:6048e5,months:2592e6,years:31536e6}[n]*a||0);default:return wp.hooks.applyFilters("optincraft_is_campaign_display_frequency_reached",!1,t)}}catch(t){return console.warn("Failed to check campaign display frequency:",t),!1}}(n))return}const k=()=>{if(!n.isShowing)return;o.style.zIndex="100000";const t=n.type,e={popup:"translate(-50%, -50%) scale(1)",slide_in:"translate(0, 0) scale(1)",floating_bar:"translate(0, 0) scale(1)"};var a;if("fade_in"!==c)return["slide_in_left","slide_in_right","slide_in_down","slide_in_up"].includes(c)?(o.style.opacity="1","slide_in_down"===c&&"floating_bar"===t&&(o.style.transition="transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s ease-out",o.style.willChange="transform"),o.style.transform="popup"===t?"translate(-50%, -50%)":"translate(0,0)",void("slide_in_down"===c&&"floating_bar"===t&&setTimeout(()=>{o.style.willChange="auto"},350))):c.startsWith("back_in")?(a=c.replace("back_in_",""),o.style.opacity="1",o.style.transform={left:{popup:"translate(calc( -50% + 20px ), -50%) scale(0.8)",slide_in:"translate(calc( 50% - 20px ), 0) scale(0.8)",floating_bar:"translate(0,0) scale(0.8)"},right:{popup:"translate(-50%,-50%) scale(0.8)",slide_in:"translate(0,0) scale(0.8)",floating_bar:"translate(0,0) scale(0.8)"},up:{popup:"translate(-50%,-50%) scale(0.8)",slide_in:"translate(0,0) scale(0.8)",floating_bar:"translate(0,0) scale(0.8)"},down:{popup:"translate(-50%,-50%) scale(0.8)",slide_in:"translate(0,0) scale(0.8)",floating_bar:"translate(0,0) scale(0.8)"}}[a][t],void setTimeout(()=>{o.style.transform=e[t]},560)):"bounce_in"===c?(()=>{o.style.opacity="1";const e="popup"===t?"translate(-50%, -50%)":"translate(0,0)";o.style.transform=`${e} scale(1.05)`,setTimeout(()=>{o.style.transform=`${e} scale(0.9)`},350),setTimeout(()=>{o.style.transform=`${e} scale(1)`},550)})():"rotate_in"===c?(()=>{o.style.opacity="1";const e="popup"===t?"translate(-50%, -50%)":"translate(0,0)";o.style.transform=`${e} rotate(20deg)`,setTimeout(()=>{o.style.transform=`${e} rotate(0deg)`},550)})():"zoom_in"===c?(()=>{o.style.opacity="1";const e="popup"===t?"translate(-50%, -50%)":"translate(0,0)";o.style.transform=`${e} scale(1.05)`,setTimeout(()=>{o.style.transform=`${e} scale(1)`},350)})():void 0;o.style.opacity="1"},C=t=>{const e=a.ref?.closest(".optincraft-campaign"),o=e?.querySelector(".optincraft-campaign-overlay");if(o&&(o.style.height="100%",o.style.width="100%"),"slide_in_down"===c&&"floating_bar"===n.type&&i){const e=i,o="0.3s cubic-bezier(0.4, 0, 0.2, 1)";return e.style.transition=`height ${o}`,e.style.willChange="height",e.style.height=w(n.height),void requestAnimationFrame(()=>{requestAnimationFrame(()=>{m(n),k(),setTimeout(()=>{e.style.willChange="auto"},350),t(),wp.hooks.doAction("optincraft_campaign_opened",n,a)})})}m(n),k(),t(),wp.hooks.doAction("optincraft_campaign_opened",n,a)};switch(function(){const n=t(),a=e();O(a.ref).on("click",".x-currency ul li",function(){h(n)})}(),s.open_event){case"on_load":{var L;const t=null!==(L=s.open_delay)&&void 0!==L?L:1;setTimeout(()=>{"floating_bar"===n.type&&"slide_in_down"!==c&&(i.style.height=w(n.height)),"popup"!==n.type&&"slide_in"!==n.type||(i.style.height=w(n.height),o.style.display="block")},1e3*t-500),setTimeout(()=>{C(()=>{})},1e3*t);break}case"after_inactivity":{var F;const t=1e3*(null!==(F=s.after_inactivity_time)&&void 0!==F?F:30);let e=null,a=!1;const r=()=>{e&&clearTimeout(e),window.removeEventListener("mousemove",p),window.removeEventListener("mousedown",p),window.removeEventListener("keypress",p),window.removeEventListener("scroll",p),window.removeEventListener("touchstart",p)},l=()=>{a||(a=!0,C(r))},p=()=>{e&&clearTimeout(e),setTimeout(()=>{"floating_bar"===n.type&&"slide_in_down"!==c&&(i.style.height=w(n.height)),"popup"!==n.type&&"slide_in"!==n.type||(i.style.height=w(n.height),o.style.display="block")},t-500),e=setTimeout(l,t)};["mousemove","mousedown","keypress","scroll","touchstart"].forEach(t=>window.addEventListener(t,p)),p();break}case"click_count":{var z;const t=null!==(z=s.click_count)&&void 0!==z?z:1;let e=0;const a=()=>{window.removeEventListener("click",l)},r=()=>{C(a)},l=()=>{"floating_bar"===n.type&&"slide_in_down"!==c&&(i.style.height=w(n.height)),"popup"!==n.type&&"slide_in"!==n.type||(i.style.height=w(n.height),o.style.display="block"),++e>=t&&setTimeout(()=>{"floating_bar"===n.type&&r()},300)};window.addEventListener("click",l);break}default:wp.hooks.doAction("optincraft_campaign_open_event",s.open_event,n,o,i,s,C)}},initForm:function(){const n=t(),a=e(),o=a.ref,i=jQuery;i(o).on("submit",async function(t){if(t.preventDefault(),!n.isFormSubmitting){n.isFormSubmitting=!0;var e=i(this).serializeArray().reduce(function(t,e){return t[e.name]=e.value,t},{});i(o).find("input, select, textarea").prop("disabled",!0),h(n),await u({path:"/optincraft/responses",method:"POST",data:{campaign_id:n.campaign_id,form_data:e}}).finally(()=>{n.isFormSubmitting=!1,i(o).find("input, select, textarea").prop("disabled",!1)}),i(o).trigger("reset"),u({path:"/optincraft/queue/dispatch",method:"POST"}),"next-step"!==n.form_after_submit?("redirect-url"===n.form_after_submit&&(window.location.href=n.form_redirect_url||"https://crafium.com/optincraft"),y(a,n)):v(n)}})},initCountdown:function(){const e=t(),n=window.moment,a="true"===e.use_user_timezone;let o=a?n.utc(e.due_date):n(e.due_date);const i=a?n.utc():n(),s=o.diff(i);e.show_countdown=!0;const r=e.time_left;let l=null;s>0&&(l=setInterval(function(){const t=a?n.utc():n(),i=o.diff(t);if(i>0){const t=n.duration(i);r.days=Math.floor(t.asDays()),r.hours=t.hours(),r.minutes=t.minutes(),r.seconds=t.seconds()}else r.days=0,r.hours=0,r.minutes=0,r.seconds=0,null!==l&&(clearInterval(l),l=null),"hide_counter"===e.action?e.show_countdown=!1:"show_message"===e.action?(e.show_countdown=!1,e.show_action_message=!0):"redirect_to_url"===e.action?e.redirect_url&&(window.location.href=e.redirect_url):"next-step"===e.action&&v(e)},1e3))},initFont:function(){const e=t().fontFamilies;for(const t of e)L(t.family,t.variations)}},actions:{onClickButton:()=>{const n=t();if("none"!==n.action)switch(n.track_conversion&&d(Number(n.campaign_id),"conversion"),n.action){case"redirect-url":window.location.href=n.redirect_url;break;case"close":y(e(),n);break;case"next-step":v(n)}},onClickOutside:()=>{const n=t();n.settings.close_on_click_outside&&y(e(),n)}}}),document.addEventListener("DOMContentLoaded",async()=>{try{await a({path:"/optincraft/events",method:"POST",data:{event_type:"view",page_url:window.location.href,referrer:p(),device:r(),browser:l(),visitor_id:i(),session_id:s()}})}catch(t){}});